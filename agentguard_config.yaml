# ============================================================================
# AGENTGUARD CONFIGURATION
# ============================================================================
#
# This file controls AgentGuard enforcement behavior.
# Customize policies, thresholds, and features for your environment.
#
# ============================================================================

# Policy enforcement rules
policies:
  
  # Balance operations (financial safety)
  balance_operations:
    require_auth: true          # Require authorization check before balance changes
    require_validation: true    # Require amount validation
  
  # Delete operations (data safety)
  delete_operations:
    allow_delete_all: false     # Block .all().delete() patterns
    max_delete_count: 1000      # Max records to delete without approval
  
  # Data sensitivity (compliance)
  data_sensitivity:
    block_pii_to_logger: true           # Block PII in logs
    block_credentials_to_network: true  # Block credentials over network
    block_ssn_everywhere: true          # SSN never allowed anywhere


# State & History Guard configuration
state_guard:
  delete_spree_threshold: 3       # Max deletes before blocking
  retry_limit: 5                  # Max retries before flagging as evasion
  session_timeout_minutes: 60     # Session expires after inactivity
  enable_cross_session: true      # Track agents across sessions
  enable_behavioral_baseline: true # Learn normal agent behavior


# Execution Sandbox configuration
sandbox:
  max_memory_mb: 512             # Maximum memory per execution
  max_cpu_seconds: 10            # Maximum CPU time
  network: blocked               # Network access: blocked | whitelist | allow
  filesystem: read-only          # Filesystem: read-only | read-write | blocked
  
  # Network whitelist (if network: whitelist)
  network_whitelist:
    - api.stripe.com
    - api.openai.com
    - "*.amazonaws.com"


# Approval workflow configuration
approval:
  enabled: true                    # Enable human approval workflow
  
  # Operations requiring approval
  require_for_drop_table: true     # DROP TABLE requires approval
  require_for_delete_over: 1000    # Deletes > 1000 records require approval
  require_for_transfer_over: 100000 # Transfers > $100K require approval
  
  # Approval levels
  levels:
    manager:   { max_impact: 10000 }
    director:  { max_impact: 100000 }
    vp:        { max_impact: 1000000 }
    cto:       { max_impact: unlimited }
  
  # Notification channels
  notifications:
    slack:
      enabled: true
      webhook_url: "https://hooks.slack.com/services/YOUR/WEBHOOK"
    
    email:
      enabled: true
      smtp_server: "smtp.gmail.com"
      from: "agentguard@company.com"
      to: ["security-team@company.com"]


# Domain-specific configurations
domains:
  
  # Financial domain
  financial:
    enabled: true
    max_transfer_amount: 100000      # $100K max transfer
    require_duplicate_check: true
    require_fraud_check: true
  
  # Healthcare domain (HIPAA)
  healthcare:
    enabled: true
    require_hipaa_consent: true
    require_encryption: true
    audit_retention_days: 2555       # 7 years
  
  # Infrastructure domain
  infrastructure:
    enabled: true
    require_change_ticket: true
    require_rollback_plan: true
    max_scale_instances: 100


# Compliance frameworks
compliance:
  
  pii:
    enabled: true
    classifications:
      - ssn
      - email
      - phone
      - address
      - dob
    blocked_sinks:
      - logger
      - print
      - console
      - network
  
  pci:
    enabled: true
    require_tokenization: true
    allowed_endpoints:
      - "https://api.stripe.com/*"
      - "https://secure-payment-gateway.com/*"
  
  hipaa:
    enabled: true
    require_consent: true
    require_audit_trail: true
    require_encryption: true


# Observability & Telemetry
observability:
  enable_metrics: true             # Prometheus metrics
  enable_audit_log: true           # Audit logging
  enable_dashboard: true           # Web dashboard
  
  log_level: INFO                  # DEBUG | INFO | WARN | ERROR
  
  # Retention periods
  metrics_retention_days: 90
  audit_log_retention_days: 2555   # 7 years for compliance
  
  # Export to external systems
  export:
    prometheus:
      enabled: true
      port: 9090
    
    splunk:
      enabled: false
      hec_url: ""
      token: ""
    
    datadog:
      enabled: false
      api_key: ""


# Feature flags (for gradual rollout)
features:
  enable_layer1: true   # Policy Guard
  enable_layer2: true   # Semantic Guard
  enable_layer3: true   # Data Sensitivity
  enable_layer4: true   # State & History
  enable_layer5: true   # Execution Sandbox
  enable_layer6: true   # Human Approval
  
  # Beta features
  enable_multi_language: true
  enable_behavioral_anomaly: true
  enable_distributed_agents: false  # Coming soon


# Performance tuning
performance:
  max_concurrent_enforcements: 100
  cache_policy_results: true
  cache_ttl_seconds: 300
  
  # Rate limiting
  rate_limit:
    enabled: true
    requests_per_minute: 1000
    burst: 100


# Custom policies (advanced)
custom_policies:
  
  # Example: Block cryptocurrency operations
  - name: "NO_CRYPTO_OPERATIONS"
    pattern: "(bitcoin|ethereum|crypto|wallet)"
    severity: HIGH
    action: BLOCK
  
  # Example: Require approval for production deployments
  - name: "PROD_DEPLOYMENT_APPROVAL"
    pattern: "deploy.*production"
    severity: CRITICAL
    action: REQUIRE_APPROVAL